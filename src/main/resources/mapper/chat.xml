<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.repository.ChatRepository">

	<insert id="createRoom">
		insert into chat_room_tb(name, head_count)
		values(#{name}, #{headCount})
	</insert>

	<insert id="joinRoom">
		insert into chat_room_join_tb(user_id, room_id)
		values(#{userId}, #{roomId})
	</insert>

	<select id="selectMatchRoom" resultType="Integer">
		select LAST_INSERT_ID()
	</select>

	<select id="getUserList" resultType="Integer">
		select user_id from
		chat_room_join_tb where room_id = #{roomId}
	</select>

	<select id="checkRoom1vs1" resultType="Integer">
		SELECT room_id
		FROM chat_room_join_tb
		WHERE user_id IN (#{userId_1}, #{userId_2})
		GROUP BY room_id
		HAVING COUNT(DISTINCT user_id) = 2;
	</select>
</mapper>