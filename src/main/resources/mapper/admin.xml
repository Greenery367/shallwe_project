<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.repository.AdminRepository">

	<!-- 전체 유저수 계산 -->
	<select id="countNumberOfUser" resultType="int">
		select count(*) from user_tb
	</select>

	<!-- 전체유저 충전 금액 -->
	<select id="countChargeAmount"> 
		select sum(charge) from user_cash_history_tb where spend is null
	</select>

	<!-- 전체유저 사용 금액  -->
	<select id="countSpendAmount"> 
		select sum(spend) from user_cash_history_tb where charge is null
	</select>
	
	<!-- 캐쉬 사용률 -->
	<select id="countSpendAmountRate">
		select round(sum(spend) / sum(charge) * 100, 1) from user_cash_history_tb
	</select>
	
	<!-- 전체 광고 조회 -->
	<select id="selectAllAdvertise">
		select * from advertise_tb;
	</select>
	
	<!-- 광고 추가 -->
	<insert id="insertAdvertise">
		insert into advertise_tb(place_id, title, customer, link, origin_file_name, upload_file_name, start_date, end_date)
		values(#{placeId}, #{title}, #{customer}, #{link}, #{originFileName}, #{uploadFileName}, #{startDate}, #{endDate})
	</insert>
	
	<!-- 광고 상태 변경 -->
	<update id="updateAdvertiseStatus">
		update advertise_tb set status = #{status} where id=#{id}
	</update>


</mapper>