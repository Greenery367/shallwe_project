<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.repository.LectureRepository">
<select id="findCategoryByLecture" resultType="com.example.demo.repository.model.Lecture">
	select 
		c.id, 
            c.category_id, 
            u.nickname AS nickName, 
            c.title, 
            c.subtitle, 
            c.content, 
            c.limit_num AS limitNum, 
            c.current_num AS currentNum, 
            c.price, 
            c.total_num AS totalNum, 
            c.created_at AS createdAt,
            u.upload_file_name AS uploadFileName
        FROM 
            class_tb c
        JOIN 
            user_tb u ON c.author_id = u.user_id
        WHERE 
            c.category_id = #{categoryId}
</select>

<select id="LectureFindById" resultType="com.example.demo.repository.model.Lecture">
	 select 
        c.id, 
	 	c.author_id,
        c.category_id, 
        u.nickname AS nickName, 
        c.title, 
        c.subtitle, 
        c.content, 
        c.limit_num AS limitNum, 
        c.current_num AS currentNum, 
        c.price, 
        c.total_num AS totalNum, 
        c.created_at AS createdAt,
        u.upload_file_name AS uploadFileName
    from 
        class_tb c
    join 
        user_tb u on c.author_id = u.user_id
    where 
        c.id = #{id};
</select>


<select id="findLectureListByUserId" resultType="com.example.demo.repository.model.Lecture">
	select 
		c.id, 
            c.category_id, 
            u.nickname AS nickName, 
            c.title, 
            c.subtitle, 
            c.content, 
            c.limit_num AS limitNum, 
            c.current_num AS currentNum, 
            c.price, 
            c.total_num AS totalNum, 
            c.created_at AS createdAt,
            u.upload_file_name AS uploadFileName
        FROM 
            class_tb c
        JOIN 
            user_tb u ON c.author_id = u.user_id
        WHERE 
            u.user_id = #{userId}
</select>

<update id="updateLecture">
	update class_tb
	set category_id = #{categoryId}, title = #{title}, subtitle = #{subtitle}, content = #{content},
		limit_num = #{limitNum}, price = #{price}, total_num = #{totalNum}
	where id = #{id}
</update>


<select id="getCategoryList" resultType="com.example.demo.repository.model.Category">
	select * from game_tb
</select>

<insert id="insertLecture">
	INSERT INTO class_tb 
			(category_id, author_id, title, subtitle, content, 
			limit_num, price, total_num)
	VALUES
			(#{categoryId}, #{authorId}, #{title}, #{subtitle}, #{content}, #{limitNum}, #{price}, #{totalNum})
</insert>

<delete id="deleteLecture">
	delete from class_tb
	where id = #{lectureId}
	
</delete>


</mapper>